# moscityhack2022
сервис для волонтеров реализованный в рамках хакатона

Публичная часть сервиса доступна по адресу http://2.59.42.236/

Front и Back интегрированы по API.

Frontend реализован на React (Typescript) с помощью Create React App (встроенные Babel и Webpack)

Backend реализован на PHP + MySQL. Для работы API реализован сотсвтенный модуль https://github.com/ShvedAn/moscityhack2022/tree/main/bitrix/modules/utopia.core/lib - все методы модуля и компонентов покрыты коментариями. Демо контент (мероприятия) взяты с сайта https://mosvolonter.ru/ - написан простой парсер календаря для копирования всех мероприятий. Для удобвства работы с контентом используется Административная панель сайта Битрикс. (фронтент от Битрикс не используется). При реализации MVP используются методы CMF - https://dev.1c-bitrix.ru/api_d7/

Логика работы Backend разделена на копоненты - выполняют роль ендпойнтов API. И методы модуля получающие данные из базы.

В дальнейшем можно оставить Битрикс для удобства работы администратора сайта с контентом и управлением профилями пользователей или после этапа прототипирования заметь Битрикс на другой феймворк, например symfony.

# API методы
Реализованы API методы (эти методы используются на frontend):

Получение списка мероприятий - используется для карты и для превью вижетов списка мероприятий
http://2.59.42.236/api/events/list/ Метод возвращает json. Можно увидеть прямым обращением через браузер.

Заявка на участие
http://2.59.42.236/api/events/subscription/?event=39&userid=3&unsubscribe=y
- event - id мероприятия. Обязательный параметр
- userid - id пользователя отправляющего запрос. В рамках MVP работает только с одним пользователем для демонстрации. Так фуникционал авторизации и регисрации пользователей в рамках хакатона приняли решение пропустить.
- unsubscribe - не обязательный параметр. При передаче этого параметра со значением "y" - пользователь будет отписан с мероприятия.

Фильтрация мероприятий
- http://2.59.42.236/api/events/list/?SUBJECT[]=subject_6 - фильтрация по одной тематике 
- http://2.59.42.236/api/events/list/?SUBJECT[]=subject_6&SUBJECT[]=subject_5 - фильтрация по нескольким тематикам

В данный момент доступны типы мероприятий:
- subject_1 - Найти пропавших
- subject_2 - Позаботиться о природе
- subject_3 - Помощь животны
- subject_4 - Помочь больным
- subject_5 - Работа в поликлиниках
- subject_6 - Сделать город чище
- subject_7 - Популяризация спорта
- subject_8 - Внимание детям
- subject_9 - Помощь пенсионерам
- subject_10 - Помощь на культурных проектах

Новые параметры может завести контент менеджер через административную часть.

Фильтрация навыков
- http://2.59.42.236/api/events/list/?SKIL[]=skil_1 - фильтр по одному навыку 
- http://2.59.42.236/api/events/list/?SKIL[]=skil_1&SKILS[]=skil_2 - фильтрация по нескольким навыкам

В данный момент доступны типы навыков:
- skil_1 - Подъем грузов
- skil_2 - Вождение автомобиля
- skil_3 - Общение с детьми
- skil_4 - Уход за больными
- 
Новые параметры может завести контент менеджер через административную часть.

Фильтрация по возрасту
- http://2.59.42.236/api/events/list/?AGE[]=age_1 - фильтр по одному возрастному диапазону 
- http://2.59.42.236/api/events/list/?AGE[]=age_1&AGE[]=age_2 - фильтрация по нескольким возростным диапазонам

В данный момент доступны типы навыков:
- age_1 - 18 и меньше
- age_2 - от 18 до 45
- age_3 - 45+

Новые параметры может завести контент менеджер через административную часть.

фильтрация по району города 
- http://2.59.42.236/api/events/list/?REGION[]=region_1 - фильтр по одному району города 
- http://2.59.42.236/api/events/list/?REGION[]=region_1&REGION[]=region_2 - фильтрация по нескольким районам города

В данный момент доступны типы навыков:
- region_1 - ЦАО
- region_2 - ЮВАО
- region_3 - САО

Новые параметры может завести контент менеджер через административную часть.

Фильтрация по типу мероприятия Офлайн/Онлайн http://2.59.42.236/api/events/list/?FORMAT[]=online

В данный момент доступны типы навыков:
- online - Онлайн
- offline - Офлайн

Новые параметры может завести контент менеджер через административную часть.

Получение списка мероприятий на которые записался Волонтер http://2.59.42.236/api/user/eventlist/
Метод без параметров. Позже добавим параметр отдельного получения архивных меровприятий.

Получение списка мероприятий Организатора http://2.59.42.236/api/user/orgeventlist/
Метод без параметров. Позже добавим параметр отдельного получения архивных меровприятий.

# Контейнеры и методы развернтывания

разработку и билд Frontend выполняели в Docker
- https://github.com/ShvedAn/moscityhack2022/blob/main/front/.dockerfile

Проект можно запустить:
- Docker - https://github.com/bitrixdock/bitrixdock.git
- VMWare - образ https://www.1c-bitrix.ru/download/vmbitrix.php#tab-section-1
- Amazon EC2 - https://www.1c-bitrix.ru/download/vmbitrix.php#tab-section-3
- Архив сервиса для развертывания на уже подготовленной хостинг площадке: http://2.59.42.236:80/bitrix/backup/20220613_052740_full_e0efb48b.tar.gz

# Рекомендуемые параметры хостинг площадки
Серверная часть 

1.1. Минимальные системные требования
- Виртуальный сервер с установленной актуальной версией BitrixVM
- Процессор не менее 2x2000MHz
- Оперативная память не менее 2Gb
- RAID 1 – использовать 2 диска

1.2. Рекомендованные системные требования
- Виртуальный сервер с установленной актуальной версией BitrixVM
- Процессор не менее 2x2000MHz
- Жесткие диски RAID1 2 и более дисков
- Оперативная память 2Gb - 4Gb
- Жесткие диски NVMe SSD
- Рекомендуется отдельный от RIAD массива бэкап диск, или любое другое облачное хранилище или FTP сервер
